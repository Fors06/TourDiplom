<Window x:Class="Diplom.View.Employee.EmployeeWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local2="clr-namespace:MaterialDesignThemes.Wpf.Converters;assembly=MaterialDesignThemes.Wpf"
        xmlns:extToolkit1="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:local="clr-namespace:Diplom.View.Employee"
        mc:Ignorable="d"
        Title="EmployeeWindow" Height="450" Width="800">
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/MaterialDesignThemes.Wpf;component/Themes/MaterialDesignTheme.ComboBox.xaml"/>
                <ResourceDictionary Source="pack://application:,,,/MaterialDesignColors;component/Themes/Recommended/Primary/MaterialDesignColor.Green.xaml"/>
                <ResourceDictionary Source="pack://application:,,,/MaterialDesignThemes.Wpf;component/Themes/MaterialDesignTheme.TextBox.xaml"/>
                <ResourceDictionary Source="pack://application:,,,/MaterialDesignThemes.Wpf;component/Themes/MaterialDesignTheme.ListBox.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            <local2:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        </ResourceDictionary>
    </Window.Resources>

    <Grid Style="{DynamicResource GridBackgroundStyle}">
        <extToolkit1:DrawerHost
              HorizontalAlignment="Stretch"
              VerticalAlignment="Stretch"
              BorderThickness="0"
              Margin="0">

            <!-- ЛЕВЫЙ ДРАВЕР (ПОПУТНАЯ ПАНЕЛЬ) -->
            <extToolkit1:DrawerHost.LeftDrawerContent>
                <StackPanel Margin="0,5,0,5" Width="212" Background="White">
                    <Button Content="Выход" Height="30"
                            Command="{Binding GoToEntranceCommand}"
                            CommandParameter="{Binding RelativeSource={RelativeSource Self}}"
                            Style="{StaticResource MaterialDesignFlatButton}"/>

                    <Separator Style="{StaticResource MaterialDesignSeparator}" Margin="10"/>

                    <Button
                         Command="{x:Static extToolkit1:DrawerHost.CloseDrawerCommand}"
                         CommandParameter="{x:Static Dock.Left}"
                         Margin="4"
                         HorizontalAlignment="Center"
                         Style="{DynamicResource MaterialDesignFlatButton}">
                        <StackPanel Orientation="Horizontal">
                            <extToolkit1:PackIcon Kind="CloseBoxOutline" Foreground="{StaticResource MaterialDesign.Brush.Primary.Dark}"
                                              Height="25" Width="25"/>
                            <TextBlock Text="Закрыть" Foreground="{StaticResource MaterialDesign.Brush.Primary.Dark}" Margin="3"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </extToolkit1:DrawerHost.LeftDrawerContent>

            <!-- ОСНОВНОЙ КОНТЕНТ -->
            <Grid Style="{StaticResource GridBackgroundStyle}">
                <!-- Верхняя панель -->
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="0,10,0,0">
                    <Button x:Name="ButtonOpen" VerticalAlignment="Top"  Margin="0,0,10,0"
                             Background="{x:Null}" BorderBrush="{x:Null}" Width="41" Height="26" Padding="0"
                             Command="{x:Static extToolkit1:DrawerHost.OpenDrawerCommand}"
                             CommandParameter="{x:Static Dock.Left}">
                        <extToolkit1:PackIcon Kind="Menu" Foreground="{StaticResource MaterialDesign.Brush.Primary.Dark}" Width="37" Height="28" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Button>
                    <TextBlock Text="Общий обзор:" FontWeight="Bold" Foreground="White" FontSize="16"/>
                    <ListBox Style="{StaticResource MaterialDesignCardsListBox}"
                              Width="200" FontSize="16"
                             Foreground="White" BorderBrush="White"/>
                    <Button Content="Новый заказ" Command="{Binding OpenCreateOrderFormCommand}" Margin="10,0,0,0" Style="{StaticResource ButtonStyle}"/>
                    <Button Content="Редактировать" Command="{Binding OpenEditOrderFormCommand}" Margin="10,0,0,0" Style="{StaticResource ButtonStyle}"
                            CommandParameter="{Binding RelativeSource={RelativeSource Self}}"/>
                    <Button Content="Обновить" Command="{Binding UpdateCommand}" Margin="10,0,0,0" Style="{StaticResource ButtonStyle}"/>
                </StackPanel>

                <!-- Основная рабочая область -->
                <Grid Margin="0,50,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Левый блок: Список выполняемых работ -->
                    <Border Grid.Column="0" BorderBrush="LightGray" BorderThickness="1" MinWidth="250" Margin="0,10,10,10">
                        <StackPanel Margin="10">
                            <TextBlock Text="Забронированные туры:" FontWeight="Bold" Foreground="White"/>

                            <DataGrid Grid.Row="2" ItemsSource="{Binding Bookings}" SelectedItem="{Binding SelectedBooking}"
                                      AutoGenerateColumns="False" Margin="5,10,1,10" FontSize="16"
                                      CanUserAddRows="False" SelectionMode="Single"> 
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Название" Binding="{Binding Tours.Название}" Width="*"/>
                                    <DataGridTextColumn Header="Клиент" Binding="{Binding Clients.Users.ФИО}" Width="*"/>
                                    <DataGridTextColumn Header="Цена" Binding="{Binding Tours.Цена}" Width="*"/>
                                    <DataGridTextColumn Header="Начало-Окончание" Width="*">
                                        <DataGridTextColumn.Binding>
                                            <MultiBinding StringFormat="{} {0} - {1}">
                                                <Binding Path="ДатаНачала"/>
                                                <Binding Path="ДатаОкончания"/>
                                            </MultiBinding>
                                        </DataGridTextColumn.Binding>
                                    </DataGridTextColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </StackPanel>
                    </Border>

                    <!-- Правый блок: История обращений клиентов -->
                    <Border Grid.Column="1" BorderBrush="LightGray" BorderThickness="1" Margin="10,10,0,10">
                        <StackPanel Margin="10">
                            <TextBlock Text="Туры:" FontWeight="Bold" Foreground="White"/>

                            <DataGrid Grid.Row="2" ItemsSource="{Binding Tours}" SelectedItem="{Binding SelectedTour}"
                                      AutoGenerateColumns="False" Margin="5,10,1,10" FontSize="16"
                                      CanUserAddRows="False" SelectionMode="Single" Grid.ColumnSpan="2"> 
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Название" Binding="{Binding Название}" Width="*"/>
                                    <DataGridTextColumn Header="Описание" Binding="{Binding Описание}" Width="*"/>
                                    <DataGridTextColumn Header="Цена" Binding="{Binding Цена}" Width="*"/>
                                    <DataGridTextColumn Header="Длительность (дни)" Binding="{Binding ДлительностьДней}" Width="*"/>
                                </DataGrid.Columns>
                            </DataGrid>

                        </StackPanel>
                    </Border>
                </Grid>
            </Grid>
        </extToolkit1:DrawerHost>
    </Grid>
</Window>
